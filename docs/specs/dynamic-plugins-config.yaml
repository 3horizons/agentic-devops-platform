# ============================================================
# Three Horizons Portal — Dynamic Plugins Configuration
# Generated by @platform | ADR-001, ADR-002
#
# How to use: Merge this into your dynamic-plugins-config.yaml
#             or add to the ConfigMap rhdh-demo-developer-hub-app-config
#
# Source: agents/rhdh-architect/skills/rhdh-plugin-design/assets/
#         dynamic-plugins-three-horizons.yaml
#
# This configures all 13 pages of the Three Horizons Portal:
#   1.  Home               → HomeIcon               → /                (custom plugin, Phase 3)
#   2.  My Group            → GroupIcon              → /my-group        (custom plugin, Phase 3)
#   3.  Catalog             → CategoryIcon           → /catalog         (native)
#   4.  APIs                → ExtensionIcon          → /api-docs        (native)
#   5.  Create              → CreateComponentIcon    → /create          (native scaffolder)
#   6.  Docs                → LibraryBooksIcon       → /docs            (native techdocs)
#   7.  Lightspeed          → ChatIcon               → /lightspeed      (dynamic plugin)
#   8.  Copilot Metrics     → AssessmentIcon         → /copilot-metrics (custom plugin)
#   9.  GHAS Metrics        → SecurityIcon           → /ghas-metrics    (custom plugin)
#  10.  Notifications       → NotificationsIcon      → /notifications   (dynamic plugin)
#  11.  Administration      → AdminPanelSettingsIcon → /admin/rbac      (native RBAC)
#  12.  Settings            → SettingsIcon           → /settings        (native)
#  13.  Topology            → StorageIcon            → /topology        (dynamic plugin)
# ============================================================

dynamicPlugins:
  frontend:

    # ══════════════════════════════════════════════════════════
    # PAGE 1: Home — Custom Three Horizons Home Page
    # ADR: ADR-001-custom-home-page-plugin.md
    # Plugin: @internal/plugin-home-three-horizons
    # Components: HeroBanner, StatCards, HorizonCards,
    #             QuickAccess, FeaturedTemplates, ColorBar
    # APIs consumed: catalogApiRef, searchApiRef, identityApiRef
    # ══════════════════════════════════════════════════════════
    "@internal/plugin-home-three-horizons":
      dynamicRoutes:
        - path: /
          importName: ThreeHorizonsHomePage
          menuItem:
            icon: HomeIcon
            text: Home

    # ══════════════════════════════════════════════════════════
    # PAGE 2: My Group — Custom Team Dashboard
    # ADR: ADR-002-custom-my-group-dashboard-plugin.md
    # Plugin: @internal/plugin-my-group-dashboard
    # Components: GroupHeader, GroupStats, MemberList,
    #             OwnedComponents
    # APIs consumed: catalogApiRef, identityApiRef
    # ══════════════════════════════════════════════════════════
    "@internal/plugin-my-group-dashboard":
      dynamicRoutes:
        - path: /my-group
          importName: MyGroupDashboard
          menuItem:
            icon: GroupIcon
            text: My Group

    # ══════════════════════════════════════════════════════════
    # SIDEBAR MENU ORDERING (RHDH main-menu-items plugin)
    # Note: This uses the RHDH-specific dict format for
    #       default.main-menu-items, NOT the standard
    #       Backstage menuItems list format.
    # Pages 3 (Catalog), 5 (Create), 12 (Settings) are
    # 100% native and only need sidebar ordering here.
    # ══════════════════════════════════════════════════════════

    # ══════════════════════════════════════════════════════════
    # PAGE 3: Catalog — Native (built-in)
    # Decision: Sidebar icon configuration only
    # ══════════════════════════════════════════════════════════
    # Catalog is 100% native; sidebar entry is built-in.

    # ══════════════════════════════════════════════════════════
    # PAGE 4: APIs — API Docs Plugin (supported dynamic plugin)
    # Decision: Enable supported RHDH dynamic plugin
    # ══════════════════════════════════════════════════════════
    backstage-plugin-api-docs:
      dynamicRoutes:
        - path: /api-docs
          importName: ApiExplorerPage
          menuItem:
            icon: ExtensionIcon
            text: APIs

    # ══════════════════════════════════════════════════════════
    # PAGE 5: Create — Native Scaffolder (100% native)
    # Decision: app-config.yaml only
    # Templates are registered via catalog locations in
    # app-config.yaml (already configured).
    # The Create page renders automatically.
    # ══════════════════════════════════════════════════════════
    # No additional config needed — Scaffolder is built-in

    # ══════════════════════════════════════════════════════════
    # PAGE 6: Docs — TechDocs Plugin (supported dynamic plugin)
    # Decision: Enable supported RHDH dynamic plugin
    # ══════════════════════════════════════════════════════════
    backstage-plugin-techdocs:
      dynamicRoutes:
        - path: /docs
          importName: TechDocsIndexPage
          menuItem:
            icon: LibraryBooksIcon
            text: Docs
        - path: /docs/:namespace/:kind/:name/*
          importName: TechDocsReaderPage

    # ══════════════════════════════════════════════════════════
    # PAGE 7: Lightspeed — AI Chat (RHDH Developer Preview)
    # Decision: Enable supported RHDH dynamic plugin
    # Requires: Azure OpenAI or RHAI model endpoint config
    # ══════════════════════════════════════════════════════════
    red-hat-developer-hub-backstage-plugin-lightspeed:
      dynamicRoutes:
        - path: /lightspeed
          importName: LightspeedPage
          menuItem:
            icon: ChatIcon
            text: Lightspeed

    # ══════════════════════════════════════════════════════════
    # PAGE 8: Copilot Metrics — Custom Dashboard
    # Plugin: @internal/plugin-copilot-metrics
    # Requires: Backend proxy to GitHub REST API
    #           (Copilot usage stats endpoint)
    # ══════════════════════════════════════════════════════════
    "@internal/plugin-copilot-metrics":
      dynamicRoutes:
        - path: /copilot-metrics
          importName: CopilotMetricsPage
          menuItem:
            icon: AssessmentIcon
            text: Copilot Metrics

    # ══════════════════════════════════════════════════════════
    # PAGE 9: GHAS Metrics — Custom Security Dashboard
    # Plugin: @internal/plugin-ghas-metrics
    # Requires: Backend proxy to GitHub REST API
    #           (Code scanning, secret scanning, Dependabot)
    # ══════════════════════════════════════════════════════════
    "@internal/plugin-ghas-metrics":
      dynamicRoutes:
        - path: /ghas-metrics
          importName: GhasMetricsPage
          menuItem:
            icon: SecurityIcon
            text: GHAS Metrics

    # ══════════════════════════════════════════════════════════
    # PAGE 10: Notifications (supported dynamic plugin)
    # Decision: Enable supported RHDH dynamic plugin
    # ══════════════════════════════════════════════════════════
    backstage-plugin-notifications:
      dynamicRoutes:
        - path: /notifications
          importName: NotificationsPage
          menuItem:
            icon: NotificationsIcon
            text: Notifications

    # ══════════════════════════════════════════════════════════
    # PAGE 11: Administration — RBAC Web UI
    # Decision: Enable supported RHDH dynamic plugin
    # Only visible to users with admin role.
    # ══════════════════════════════════════════════════════════
    janus-idp-backstage-plugin-rbac:
      dynamicRoutes:
        - path: /admin/rbac
          importName: RbacPage
          menuItem:
            icon: AdminPanelSettingsIcon
            text: Administration

    # ══════════════════════════════════════════════════════════
    # PAGE 12: Settings — Native User Settings (100% native)
    # Decision: Built-in, no additional config needed
    # ══════════════════════════════════════════════════════════
    # Settings page is always available at /settings

    # ══════════════════════════════════════════════════════════
    # PAGE 13: Topology — Kubernetes Topology View
    # Decision: Enable supported RHDH dynamic plugin
    # Provides both a standalone sidebar page and an
    # entity-level tab for components with K8s annotations.
    # ══════════════════════════════════════════════════════════
    janus-idp-backstage-plugin-topology:
      dynamicRoutes:
        - path: /topology
          importName: TopologyPage
          menuItem:
            icon: StorageIcon
            text: Topology
      mountPoints:
        - mountPoint: entity.page.kubernetes/cards
          importName: TopologyPage
          config:
            if:
              allOf:
                - isKind: component
                - hasAnnotation: backstage.io/kubernetes-id

    # ══════════════════════════════════════════════════════════
    # HOME PAGE WIDGETS — SearchBar and QuickAccessCard
    # Dynamic Home Page plugin for the default home layout
    # ══════════════════════════════════════════════════════════
    red-hat-developer-hub.backstage-plugin-dynamic-home-page:
      mountPoints:
        - importName: SearchBar
          mountPoint: home.page/cards
          config:
            layouts:
              xl: { h: 1, w: 10, x: 1 }
              lg: { h: 1, w: 10, x: 1 }
              md: { h: 1, w: 10, x: 1 }
              sm: { h: 1, w: 10, x: 1 }
              xs: { h: 1, w: 12 }
              xxs: { h: 1, w: 12 }
        - importName: QuickAccessCard
          mountPoint: home.page/cards
          config:
            layouts:
              xl: { h: 8, w: 7 }
              lg: { h: 8, w: 7 }
              md: { h: 8, w: 7 }
              sm: { h: 8, w: 12 }
              xs: { h: 8, w: 12 }
              xxs: { h: 8, w: 12 }
        - importName: CatalogStarredEntitiesCard
          mountPoint: home.page/cards
          config:
            layouts:
              xl: { h: 4, w: 5, x: 7 }
              lg: { h: 4, w: 5, x: 7 }
              md: { h: 4, w: 5, x: 7 }
              sm: { h: 4, w: 12 }
              xs: { h: 4, w: 12 }
              xxs: { h: 4, w: 12 }
        - importName: FeaturedDocsCard
          mountPoint: home.page/cards
          config:
            layouts:
              xl: { h: 4, w: 5, x: 7 }
              lg: { h: 4, w: 5, x: 7 }
              md: { h: 4, w: 5, x: 7 }
              sm: { h: 4, w: 12 }
              xs: { h: 4, w: 12 }
              xxs: { h: 4, w: 12 }
