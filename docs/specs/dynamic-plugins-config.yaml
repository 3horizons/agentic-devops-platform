# ============================================================
# Three Horizons Portal — Dynamic Plugins Configuration
# Generated by @rhdh-architect | ADR-001, ADR-002
#
# How to use: Merge this into your dynamic-plugins-config.yaml
#             or add to the ConfigMap rhdh-demo-developer-hub-app-config
#
# This configures all 11 pages of the Three Horizons Portal:
#   1. Home (custom plugin)
#   2. My Group (custom plugin)
#   3. Catalog (native)
#   4. APIs (native + plugin)
#   5. Learning Paths (TechDocs route)
#   6. Create (native)
#   7. Docs (native)
#   8. Lightspeed (dynamic plugin)
#   9. Notifications (dynamic plugin)
#  10. Administration (RBAC plugin)
#  11. Settings (native)
# ============================================================

dynamicPlugins:
  frontend:

    # ══════════════════════════════════════════════════════════
    # PAGE 1: Home — Custom Three Horizons Home Page
    # ADR: ADR-001-custom-home-page-plugin.md
    # Plugin: @internal/plugin-home-three-horizons
    # Components: HeroBanner, StatCards, HorizonCards,
    #             QuickAccess, FeaturedTemplates, ColorBar
    # APIs consumed: catalogApiRef, searchApiRef, identityApiRef
    # ══════════════════════════════════════════════════════════
    "@internal/plugin-home-three-horizons":
      dynamicRoutes:
        - path: /
          importName: ThreeHorizonsHomePage
          menuItem:
            icon: HomeIcon
            text: Home

    # ══════════════════════════════════════════════════════════
    # PAGE 2: My Group — Custom Team Dashboard
    # ADR: ADR-002-custom-my-group-dashboard-plugin.md
    # Plugin: @internal/plugin-my-group-dashboard
    # Components: GroupHeader, GroupStats, MemberList,
    #             OwnedComponents
    # APIs consumed: catalogApiRef, identityApiRef
    # ══════════════════════════════════════════════════════════
    "@internal/plugin-my-group-dashboard":
      dynamicRoutes:
        - path: /my-group
          importName: MyGroupDashboard
          menuItem:
            icon: GroupIcon
            text: My Group

    # ══════════════════════════════════════════════════════════
    # SIDEBAR MENU ORDERING (RHDH main-menu-items plugin)
    # Note: This uses the RHDH-specific dict format for
    #       default.main-menu-items, NOT the standard
    #       Backstage menuItems list format.
    # Pages 3 (Catalog), 6 (Create), 11 (Settings) are
    # 100% native and only need sidebar ordering here.
    # ══════════════════════════════════════════════════════════

    # ══════════════════════════════════════════════════════════
    # PAGE 4: APIs — API Docs Plugin (supported dynamic plugin)
    # Decision: Enable supported RHDH dynamic plugin
    # ══════════════════════════════════════════════════════════
    backstage-plugin-api-docs:
      dynamicRoutes:
        - path: /api-docs
          importName: ApiExplorerPage
          menuItem:
            icon: ExtensionIcon
            text: APIs

    # ══════════════════════════════════════════════════════════
    # PAGE 5: Learning Paths — TechDocs Route
    # Decision: Use TechDocs native plugin with a dedicated
    #           mkdocs site for learning content. If richer UX
    #           is needed later, build custom plugin (Phase 2).
    # ══════════════════════════════════════════════════════════
    # Option A: Learning Paths as a TechDocs filter (native)
    # The Learning Paths sidebar entry links to /docs filtered
    # by a specific tag or TechDocs entity. No custom plugin.
    #
    # Option B (uncomment if custom plugin is built):
    # "@internal/plugin-learning-paths":
    #   dynamicRoutes:
    #     - path: /learning-paths
    #       importName: LearningPathsPage
    #       menuItem:
    #         icon: SchoolIcon
    #         text: Learning Paths

    # ══════════════════════════════════════════════════════════
    # PAGE 6: Create — Native Scaffolder (100% native)
    # Decision: app-config.yaml only
    # Templates are registered via catalog locations in
    # app-config.yaml (already configured).
    # The Create page renders automatically.
    # ══════════════════════════════════════════════════════════
    # No additional config needed — Scaffolder is built-in

    # ══════════════════════════════════════════════════════════
    # PAGE 7: Docs — TechDocs Plugin (supported dynamic plugin)
    # Decision: Enable supported RHDH dynamic plugin
    # ══════════════════════════════════════════════════════════
    backstage-plugin-techdocs:
      dynamicRoutes:
        - path: /docs
          importName: TechDocsIndexPage
          menuItem:
            icon: LibraryBooksIcon
            text: Docs
        - path: /docs/:namespace/:kind/:name/*
          importName: TechDocsReaderPage

    # ══════════════════════════════════════════════════════════
    # PAGE 8: Lightspeed — AI Chat (RHDH Developer Preview)
    # Decision: Enable supported RHDH dynamic plugin
    # Requires: Azure OpenAI or RHAI model endpoint config
    # ══════════════════════════════════════════════════════════
    red-hat-developer-hub-backstage-plugin-lightspeed:
      dynamicRoutes:
        - path: /lightspeed
          importName: LightspeedPage
          menuItem:
            icon: ChatIcon
            text: Lightspeed

    # ══════════════════════════════════════════════════════════
    # PAGE 9: Notifications (supported dynamic plugin)
    # Decision: Enable supported RHDH dynamic plugin
    # ══════════════════════════════════════════════════════════
    backstage-plugin-notifications:
      dynamicRoutes:
        - path: /notifications
          importName: NotificationsPage
          menuItem:
            icon: NotificationsIcon
            text: Notifications

    # ══════════════════════════════════════════════════════════
    # PAGE 10: Administration — RBAC Web UI
    # Decision: Enable supported RHDH dynamic plugin
    # Only visible to users with admin role.
    # ══════════════════════════════════════════════════════════
    janus-idp-backstage-plugin-rbac:
      dynamicRoutes:
        - path: /admin/rbac
          importName: RbacPage
          menuItem:
            icon: AdminPanelSettingsIcon
            text: Administration

    # ══════════════════════════════════════════════════════════
    # PAGE 11: Settings — Native User Settings (100% native)
    # Decision: Built-in, no additional config needed
    # ══════════════════════════════════════════════════════════
    # Settings page is always available at /settings

    # ══════════════════════════════════════════════════════════
    # ENTITY PAGES — Additional plugins for entity detail views
    # ══════════════════════════════════════════════════════════

    # Kubernetes Topology — entity tab for components with K8s
    janus-idp-backstage-plugin-topology:
      mountPoints:
        - mountPoint: entity.page.kubernetes/cards
          importName: TopologyPage
          config:
            if:
              allOf:
                - isKind: component
                - hasAnnotation: backstage.io/kubernetes-id

    # Dynamic Home Page plugin — for SearchBar and QuickAccessCard
    # This is a fallback for pages that use the default home layout
    red-hat-developer-hub.backstage-plugin-dynamic-home-page:
      mountPoints:
        - importName: SearchBar
          mountPoint: home.page/cards
          config:
            layouts:
              xl: { h: 1, w: 10, x: 1 }
              lg: { h: 1, w: 10, x: 1 }
              md: { h: 1, w: 10, x: 1 }
              sm: { h: 1, w: 10, x: 1 }
              xs: { h: 1, w: 12 }
              xxs: { h: 1, w: 12 }
        - importName: QuickAccessCard
          mountPoint: home.page/cards
          config:
            layouts:
              xl: { h: 8, w: 7 }
              lg: { h: 8, w: 7 }
              md: { h: 8, w: 7 }
              sm: { h: 8, w: 12 }
              xs: { h: 8, w: 12 }
              xxs: { h: 8, w: 12 }
        - importName: CatalogStarredEntitiesCard
          mountPoint: home.page/cards
          config:
            layouts:
              xl: { h: 4, w: 5, x: 7 }
              lg: { h: 4, w: 5, x: 7 }
              md: { h: 4, w: 5, x: 7 }
              sm: { h: 4, w: 12 }
              xs: { h: 4, w: 12 }
              xxs: { h: 4, w: 12 }
        - importName: FeaturedDocsCard
          mountPoint: home.page/cards
          config:
            layouts:
              xl: { h: 4, w: 5, x: 7 }
              lg: { h: 4, w: 5, x: 7 }
              md: { h: 4, w: 5, x: 7 }
              sm: { h: 4, w: 12 }
              xs: { h: 4, w: 12 }
              xxs: { h: 4, w: 12 }
