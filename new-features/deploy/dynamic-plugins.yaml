# =============================================================================
# RHDH Three Horizons — Dynamic Plugins Configuration
# For Helm values: global.dynamic.plugins
# =============================================================================

plugins:
  # ── Core Backstage Plugins ──────────────────────────────────────────────
  - package: ./dynamic-plugins/dist/backstage-plugin-home
    disabled: false

  - package: ./dynamic-plugins/dist/backstage-plugin-search
    disabled: false

  - package: ./dynamic-plugins/dist/backstage-plugin-search-backend-module-pg
    disabled: false

  - package: ./dynamic-plugins/dist/backstage-plugin-catalog
    disabled: false

  - package: ./dynamic-plugins/dist/backstage-plugin-catalog-backend-module-github-org
    disabled: false

  - package: ./dynamic-plugins/dist/backstage-plugin-catalog-backend-module-github
    disabled: false

  - package: ./dynamic-plugins/dist/backstage-plugin-scaffolder
    disabled: false

  - package: ./dynamic-plugins/dist/backstage-plugin-scaffolder-backend-module-github
    disabled: false

  - package: ./dynamic-plugins/dist/backstage-plugin-techdocs
    disabled: false

  - package: ./dynamic-plugins/dist/backstage-plugin-techdocs-backend
    disabled: false

  - package: ./dynamic-plugins/dist/backstage-plugin-api-docs
    disabled: false

  # ── GitHub Integration ──────────────────────────────────────────────────
  - package: ./dynamic-plugins/dist/backstage-plugin-github-actions
    disabled: false

  - package: ./dynamic-plugins/dist/backstage-plugin-github-issues
    disabled: false

  # ── Developer Lightspeed (AI) — Azure OpenAI ─────────────────────────────
  - package: ./dynamic-plugins/dist/redhat-plugin-developer-lightspeed
    disabled: false

  - package: ./dynamic-plugins/dist/redhat-plugin-developer-lightspeed-backend
    disabled: false
    pluginConfig:
      lightspeed:
        servers:
          - id: azure-openai-default
            url: ${AZURE_OPENAI_ENDPOINT}
            token: ${AZURE_OPENAI_KEY}

  # ── RBAC ────────────────────────────────────────────────────────────────
  - package: ./dynamic-plugins/dist/janus-idp-backstage-plugin-rbac
    disabled: false

  # ── Kubernetes ──────────────────────────────────────────────────────────
  - package: ./dynamic-plugins/dist/backstage-plugin-kubernetes
    disabled: false

  - package: ./dynamic-plugins/dist/backstage-plugin-kubernetes-backend
    disabled: false

  # ── Notifications ─────────────────────────────────────────────────────
  - package: ./dynamic-plugins/dist/backstage-plugin-notifications
    disabled: false

  - package: ./dynamic-plugins/dist/backstage-plugin-notifications-backend-dynamic
    disabled: false

  # ── Topology ────────────────────────────────────────────────────────────
  - package: ./dynamic-plugins/dist/janus-idp-backstage-plugin-topology
    disabled: false

  # ── User Settings ──────────────────────────────────────────────────────
  - package: ./dynamic-plugins/dist/backstage-plugin-user-settings
    disabled: false

  # ── Disabled Plugins (runtime-validated fixes) ──────────────────────────
  # Segment analytics — loads external scripts from cdn.segment.com, causes CSP violations
  - package: ./dynamic-plugins/dist/backstage-community-plugin-analytics-provider-segment
    disabled: true

  # Signals — WebSocket /api/signals fails without proper backend support
  - package: ./dynamic-plugins/dist/backstage-plugin-signals
    disabled: true
  - package: ./dynamic-plugins/dist/backstage-plugin-signals-backend-dynamic
    disabled: true

  # Adoption Insights — causes 'digest' TypeError (crypto context issue)
  - package: ./dynamic-plugins/dist/red-hat-developer-hub-backstage-plugin-adoption-insights
    disabled: true
  - package: ./dynamic-plugins/dist/red-hat-developer-hub-backstage-plugin-analytics-module-adoption-insights-dynamic
    disabled: true
  - package: ./dynamic-plugins/dist/red-hat-developer-hub-backstage-plugin-adoption-insights-backend-dynamic
    disabled: true
